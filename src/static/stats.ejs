---
permalink: /stats.json
---
<%

function wordCount(s) {
  if (s === undefined) return  0;
  
  let bits = s.split(/\s+/);
  if (bits) {
	   return bits.length;
   }
   return 0;
}

totalPosts=collections.posts.length;
totalWords=0;
let	tags={};
let posts = [];

collections.posts.forEach((p,i)=> {
	if(i === 0) firstPost = p;
	if(i === collections.posts.length-1) lastPost = p;

	p.data.tags.forEach(t => {
		if(!tags[t]) tags[t] = 0;
		tags[t]++;
	});

	let wc = wordCount(p.templateContent);
	totalWords += wc

	let post = {
		title: p.data.title,
		date: p.data.date,
		wordCount: wc
	};
	posts.push(post)
});

let avgWords = totalWords / totalPosts;

%>

{
	"totalPosts": <%= totalPosts %>,
	"totalWords": <%= totalWords %>,
	"avgWords": <%= avgWords %>,
	"firstPost": {
		"title": "<%= firstPost.data.title %>",
		"date": "<%= firstPost.date %>"
	},
	"lastPost": {
		"title": "<%= lastPost.data.title %>",
		"date": "<%= lastPost.date %>"
	},
	"tags": <%- JSON.stringify(tags) %>,
	"posts": <%- JSON.stringify(posts) %>
}
